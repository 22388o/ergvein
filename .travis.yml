language: nix
nix: 2.0.4
cache:
  directories:
  - "$HOME/nix.store"
before_install:
- sudo mkdir -p /etc/nix
- echo "substituters = https://cache.nixos.org/ file://$HOME/nix.store" | sudo tee
  -a /etc/nix/nix.conf > /dev/null
- echo 'require-sigs = false' | sudo tee -a /etc/nix/nix.conf > /dev/null
before_cache:
- mkdir -p $HOME/nix.store
- nix copy --to file://$HOME/nix.store -f default.nix buildInputs
before_script:
- nix-env -iA cachix -f https://cachix.org/api/v1/install
- cachix use ergvein
script:
- nix-build -A ghc.ergvein-wallet | cachix push ergvein
- nix-build -A ghc.ergvein-index-server | cachix push ergvein
- nix-build --arg isAndroid true -A android.ergvein-wallet | cachix push ergvein
env:
  global:
    secure: JymWdfF0fbmxnLnrLrFPGLJGKQ5dNjsIjfRPlIrR0VPC4Ud1PcjYpknEAHi3JCxvOu6NsEniXtcPmVTAnCRvj75Af2y0K3kjtpy0PxfIPCPLS6wKg13QSemPHQq9CMPKsbTZge0MZgPRMs5kwv1kqUEcJnZQiiA/rRkfLs0R1dK4x/eP95TL4L5vF9kEip011S0GpH2EwrfFBSB8kA5l9Qn67tHZNAy7veEi17lAtBFGwLFspWxn9Qyu3g5rgVss9UvBcXrwfkxKE8uXWznkV08xG3BuhEoesLeqKKn9dqLeHnzLyi8gkofRwgyv9qBkGGblhyFOLpLAbATRA8/kiSc7TjMFl6gHNsXtkRH0VO6DPGYJ8cptDGB/wXDan5acz7wJurCJpBmutgrE1qJP1gs+rlvhbq9XCfOrfyqLyGfSzOYdfFh4hOLitl0dQBoyApSVF8uWt8kQhF9dbAy7V2zbPsO80c6LRsIuxWifeI+rjmaYpb7AUWNYUK5VfE2IUukbV5OrZzPP4FOH8OqUOu/RLVYxK3WsyURfdZ06+E+c2CJRNY1xcwlY1IqS7SSRSkTac0UPeq7IvM0uvokydJpegn5QLYchw2TGfN8J8KulbyI7n+D+B7uZTUFYiaxcwAUWrxfPAVc5ADPdZRf0C5ThzaeThBg+r67VGTN79DE=
